<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Календарь 2025–2030 — Mini App</title>
<style>
  :root{
    --bg:#f2f4f7;
    --card:#ffffff;
    --muted:#6b6b73;
    --accent:#0a84ff;
    --accent-2:#5ac8fa;
    --radius:16px;
    --shadow-lg: 0 30px 70px rgba(12,18,30,0.12);
    --shadow-sm: 0 8px 24px rgba(12,18,30,0.06);

    --clr-red:#ff3b30;
    --clr-yellow:#ffcc00;
    --clr-green:#34c759;
    --clr-purple:#af52de;
  }

  /* Safe area + full-height */
  html,body{
    height:100%;
    margin:0;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    font-family: -apple-system, "SF Pro Text","SF Pro Display","Helvetica Neue", Arial, sans-serif;
    background: linear-gradient(180deg,#eef3f8 0%, var(--bg) 100%);
    color:#0b1226;
  }

  /* Use large viewport units for height to fit screen exactly */
  .app {
    width: 100vw;
    height: 100vh;
    box-sizing: border-box;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 12px;
    overflow: hidden;
  }

  /* Shell card */
  .shell {
    width: 100%;
    max-width: 980px;
    height: 100%;
    border-radius: 18px;
    background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,252,0.88));
    box-shadow: var(--shadow-lg);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }

  /* Header */
  .topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 18px;
    gap: 12px;
    border-bottom: 1px solid rgba(11,18,38,0.04);
    background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.4));
    flex-shrink: 0;
  }
  .brand { font-weight: 800; font-size: 17px; }
  .sub { font-size: 13px; color: var(--muted); margin-top: 4px; }

  /* Content area - two screens */
  .content {
    flex: 1 1 auto;
    display: flex;
    overflow: hidden;
    position: relative;
  }

  .screen {
    width: 100%;
    height: 100%;
    flex: 0 0 100%;
    transition: transform 360ms cubic-bezier(.2,.9,.2,1);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
    padding: 18px;
    box-sizing: border-box;
  }

  .screen.hidden-left { transform: translateX(-100%); }
  .screen.hidden-right { transform: translateX(100%); }

  /* SCREEN 1 — selector */
  .selector {
    display: flex;
    flex-direction: column;
    gap: 14px;
  }

  .panel {
    background: linear-gradient(180deg,#fff,#fbfdff);
    border-radius: 14px;
    padding: 14px;
    box-shadow: var(--shadow-sm);
  }

  .months-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }
  .month-card {
    padding: 12px;
    border-radius: 10px;
    text-align: center;
    font-weight: 800;
    cursor: pointer;
    user-select: none;
    background: transparent;
    transition: transform 180ms, box-shadow 160ms, background 180ms;
  }
  .month-card:hover { transform: translateY(-6px); box-shadow: 0 12px 30px rgba(12,18,30,0.06); }
  .month-card.active {
    background: linear-gradient(90deg,var(--accent),var(--accent-2));
    color: #fff;
    transform: translateY(-6px);
    box-shadow: 0 18px 40px rgba(10,132,255,0.14);
  }

  .year-row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin-top: 8px; }
  .year-chip {
    padding: 8px 12px; border-radius: 12px;
    background: linear-gradient(180deg,#fff,#f4f6fb);
    cursor: pointer; font-weight: 800;
    box-shadow: 0 8px 22px rgba(12,18,30,0.04);
  }
  .year-chip.active { background: linear-gradient(90deg,var(--accent),var(--accent-2)); color: #fff; transform: translateY(-3px); }

  .open-btn {
    margin-top: 12px;
    padding: 14px 18px;
    font-weight: 800;
    border-radius: 14px;
    border: none;
    background: linear-gradient(90deg,var(--accent),var(--accent-2));
    color: #fff;
    cursor: pointer;
    box-shadow: 0 18px 40px rgba(10,132,255,0.14);
  }

  /* SCREEN 2 — calendar */
  .cal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    margin-bottom: 10px;
    flex-shrink: 0;
  }
  .cal-controls { display: flex; gap: 8px; align-items: center; }
  .small-btn {
    padding: 8px 10px; border-radius: 10px; border: none; cursor: pointer; background: linear-gradient(180deg,#fff,#f4f6fb); box-shadow: var(--shadow-sm); font-weight: 800;
  }

  .month-title { font-weight: 800; font-size: 16px; }

  .main-pane {
    display: flex;
    gap: 14px;
    align-items: flex-start;
    height: calc(100% - 56px); /* header height approx */
    overflow: hidden;
  }

  .calendar {
    flex: 1;
    min-width: 0;
    background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(248,249,252,0.7));
    border-radius: 12px;
    padding: 10px;
    box-shadow: var(--shadow-sm);
    display: flex;
    flex-direction: column;
    gap: 8px;
    overflow-y: auto;
  }

  .weekdays { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; padding: 6px 6px; }
  .weekday { text-align: center; font-weight: 800; color: var(--muted); font-size: 12px; }

  .days { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; padding: 6px; }
  .day {
    aspect-ratio: 1 / 1; min-height: 52px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 10px; font-weight: 800; color: #0b1226;
    cursor: pointer; user-select: none; position: relative; transition: transform 240ms, box-shadow 200ms;
    background: transparent;
  }
  .day:hover { transform: translateY(-6px); box-shadow: 0 12px 28px rgba(12,18,30,0.06); }
  .other { color: #b7bcc1; cursor: default; transform: none; box-shadow: none; font-weight: 700; }

  .today {
    background: linear-gradient(180deg, rgba(10,132,255,0.12), rgba(10,132,255,0.06));
    color: var(--accent);
    box-shadow: 0 10px 24px rgba(10,132,255,0.06);
  }

  /* colored states */
  .color-red { background: linear-gradient(180deg,var(--clr-red), #e03a34); color: #fff; box-shadow: 0 18px 42px rgba(255,59,48,0.14); }
  .color-yellow { background: linear-gradient(180deg,var(--clr-yellow), #f2b800); color: #111; box-shadow: 0 18px 42px rgba(255,204,0,0.12); }
  .color-green { background: linear-gradient(180deg,var(--clr-green), #2fb84a); color: #fff; box-shadow: 0 18px 42px rgba(52,199,89,0.12); }
  .color-purple { background: linear-gradient(180deg,var(--clr-purple), #9b3bd6); color: #fff; box-shadow: 0 18px 42px rgba(175,82,222,0.12); }

  /* sidebar mini months + years */
  .sidebar {
    width: 220px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    overflow-y: auto;
  }
  .mini-year {
    background: linear-gradient(180deg,#fff,#fbfcff);
    padding: 10px; border-radius: 12px;
    box-shadow: var(--shadow-sm);
    display: grid; grid-template-columns: repeat(3,1fr); gap: 8px;
  }
  .mini-month { text-align: center; padding: 8px; font-weight: 800; border-radius: 10px; cursor: pointer; }
  .mini-month.active { background: linear-gradient(90deg,var(--accent),var(--accent-2)); color: #fff; transform: translateY(-3px); box-shadow: 0 12px 30px rgba(10,132,255,0.12); }

  .year-list { display: flex; gap: 8px; flex-wrap: wrap; }
  .year-chip { padding: 8px 10px; border-radius: 10px; background: linear-gradient(180deg,#fff,#f4f6fb); cursor: pointer; font-weight: 800; }
  .year-chip.active { background: linear-gradient(90deg,var(--accent),var(--accent-2)); color: #fff; transform: translateY(-3px); }

  /* footer */
  .cal-footer { margin-top: 8px; display: flex; justify-content: space-between; align-items: center; padding: 8px 4px; color: var(--muted); font-size: 13px; flex-shrink: 0; }

  /* sheet */
  .backdrop {
    position: fixed; inset: 0; z-index: 1400; background: rgba(8,10,20,0.28);
    opacity: 0; pointer-events: none; transition: opacity 220ms;
  }
  .backdrop.show { opacity: 1; pointer-events: auto; }

  .sheet {
    position: fixed; left: 50%; bottom: 0; z-index: 1401;
    transform: translate(-50%, 110%);
    width: 100%; max-width: 720px;
    border-radius: 16px 16px 6px 6px;
    background: linear-gradient(180deg, var(--card), #fbfdff);
    box-shadow: 0 40px 80px rgba(12,18,30,0.2);
    transition: transform 320ms cubic-bezier(.2,.9,.2,1), opacity 260ms;
    opacity: 0;
    padding: 12px 14px 18px;
    touch-action: none;
    max-height: 86vh;
    display: flex;
    flex-direction: column;
    gap: 12px;
    overflow: auto;
  }
  .sheet.show { transform: translate(-50%, 0%); opacity: 1; }

  .grab { width: 64px; height: 6px; background: rgba(11,18,38,0.08); border-radius: 999px; margin: 6px auto 4px; }

  .palette { display: flex; gap: 10px; align-items: center; }
  .palette .color {
    width: 44px; height: 44px; border-radius: 12px; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: var(--shadow-sm);
  }
  .palette .color .dot { width: 28px; height: 28px; border-radius: 8px; }
  .pal-red .dot { background: linear-gradient(180deg,var(--clr-red), #e03a34); }
  .pal-yellow .dot { background: linear-gradient(180deg,var(--clr-yellow), #f2b800); }
  .pal-green .dot { background: linear-gradient(180deg,var(--clr-green), #2fb84a); }
  .pal-purple .dot { background: linear-gradient(180deg,var(--clr-purple), #9b3bd6); }

  .desc {
    width: 100%;
    min-height: 72px; /* at least ~2 lines */
    max-height: 220px;
    padding: 12px;
    border-radius: 12px;
    border: 1px solid rgba(11,18,38,0.06);
    font-size: 15px;
    resize: vertical;
    background: linear-gradient(180deg,#fff,#fbfdff);
    box-shadow: inset 0 -1px 0 rgba(0,0,0,0.02);
  }

  .sheet-actions { display: flex; gap: 10px; justify-content: flex-end; }
  .act-del { padding: 10px 12px; border-radius: 12px; background: transparent; border: 1px solid rgba(11,18,38,0.06); font-weight: 800; cursor: pointer; color: var(--muted); }
  .act-save { padding: 10px 12px; border-radius: 12px; background: linear-gradient(90deg,var(--accent),var(--accent-2)); color: #fff; font-weight: 900; cursor: pointer; box-shadow: 0 12px 30px rgba(10,132,255,0.14); }

  /* small screens */
  @media (max-width: 880px){
    .sidebar { width: 100%; order: 2; }
    .main-pane { flex-direction: column; height: auto; }
    .sheet { max-width: 100%; border-radius: 12px 12px 0 0; left: 50%; }
  }

  @media (prefers-reduced-motion: reduce){
    * { transition: none !important; animation: none !important; }
  }
</style>
</head>
<body>
  <div class="app">
    <div class="shell" role="application" aria-label="Календарь 2025–2030">
      <div class="topbar">
        <div>
          <div class="brand">Бот-помощник</div>
          <div class="sub">Календарь — 2025…2030</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <button id="toSelector" class="small-btn" title="Выбор месяца">Выбор</button>
        </div>
      </div>

      <div class="content" id="content">
        <!-- Screen 1 -->
        <div id="screenSelect" class="screen">
          <div class="selector">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div style="font-weight:900;font-size:18px">Выберите год и месяц</div>
              <div style="color:var(--muted);font-weight:700">2025 — 2030</div>
            </div>

            <div class="panel">
              <div style="display:flex;flex-direction:column;gap:8px;">
                <div style="font-weight:800">Год</div>
                <div class="year-row" id="yearRow"></div>
              </div>
            </div>

            <div class="panel">
              <div style="font-weight:800;margin-bottom:8px">Месяц</div>
              <div class="months-grid" id="monthsGrid"></div>
            </div>

            <div style="display:flex;justify-content:flex-end">
              <button id="openCalendar" class="open-btn">Открыть календарь</button>
            </div>
          </div>
        </div>

        <!-- Screen 2 -->
        <div id="screenCalendar" class="screen hidden-right">
          <div class="cal-header">
            <div class="cal-controls">
              <button id="prevMonth" class="small-btn">‹</button>
              <div class="month-title" id="monthTitle">Месяц Год</div>
              <button id="nextMonth" class="small-btn">›</button>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <select id="yearSelect" style="padding:8px;border-radius:10px;border:none;background:linear-gradient(180deg,#fff,#f4f6fb);font-weight:800"></select>
            </div>
          </div>

          <div class="main-pane" style="height: calc(100% - 56px);">
            <div class="calendar" id="calendar">
              <div class="weekdays">
                <div class="weekday">Пн</div>
                <div class="weekday">Вт</div>
                <div class="weekday">Ср</div>
                <div class="weekday">Чт</div>
                <div class="weekday">Пт</div>
                <div class="weekday">Сб</div>
                <div class="weekday">Вс</div>
              </div>
              <div class="days" id="daysGrid"></div>
            </div>

            <div class="sidebar" id="sidebar">
              <!-- Мини-календари по годам и месяцам (если нужно) -->
            </div>
          </div>

          <div class="cal-footer">
            <div>© 2025</div>
            <button id="toSelectBtn" class="small-btn">Выбрать месяц</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  const YEARS = [2025,2026,2027,2028,2029,2030];
  const MONTHS = [
    'Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь',
    'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'
  ];

  // Элементы
  const screenSelect = document.getElementById('screenSelect');
  const screenCalendar = document.getElementById('screenCalendar');
  const toSelectorBtn = document.getElementById('toSelector');
  const toSelectBtn = document.getElementById('toSelectBtn');
  const openCalendarBtn = document.getElementById('openCalendar');
  const yearRow = document.getElementById('yearRow');
  const monthsGrid = document.getElementById('monthsGrid');
  const monthTitle = document.getElementById('monthTitle');
  const daysGrid = document.getElementById('daysGrid');
  const yearSelect = document.getElementById('yearSelect');
  const prevMonthBtn = document.getElementById('prevMonth');
  const nextMonthBtn = document.getElementById('nextMonth');

  let currentYear = new Date().getFullYear();
  let currentMonth = new Date().getMonth();

  if (!YEARS.includes(currentYear)) currentYear = YEARS[0];

  // Init years selector
  function renderYearRow() {
    yearRow.innerHTML = '';
    YEARS.forEach(y => {
      const btn = document.createElement('button');
      btn.textContent = y;
      btn.className = 'year-chip';
      if (y === currentYear) btn.classList.add('active');
      btn.addEventListener('click', () => {
        currentYear = y;
        updateYearSelection();
        updateMonthsSelection();
      });
      yearRow.appendChild(btn);
    });
  }

  function updateYearSelection() {
    [...yearRow.children].forEach(btn => {
      btn.classList.toggle('active', +btn.textContent === currentYear);
    });
    [...yearSelect.options].forEach(opt => {
      opt.selected = (+opt.value === currentYear);
    });
  }

  // Init months selector
  function renderMonthsGrid() {
    monthsGrid.innerHTML = '';
    MONTHS.forEach((m,i) => {
      const div = document.createElement('div');
      div.textContent = m;
      div.className = 'month-card';
      if (i === currentMonth) div.classList.add('active');
      div.addEventListener('click', () => {
        currentMonth = i;
        updateMonthsSelection();
      });
      monthsGrid.appendChild(div);
    });
  }

  function updateMonthsSelection() {
    [...monthsGrid.children].forEach((el,i) => {
      el.classList.toggle('active', i === currentMonth);
    });
  }

  // Year select dropdown in calendar screen
  function renderYearSelect() {
    yearSelect.innerHTML = '';
    YEARS.forEach(y => {
      const opt = document.createElement('option');
      opt.value = y;
      opt.textContent = y;
      if (y === currentYear) opt.selected = true;
      yearSelect.appendChild(opt);
    });
  }

  yearSelect.addEventListener('change', e => {
    currentYear = +e.target.value;
    renderCalendar(currentYear, currentMonth);
    updateYearSelection();
    updateMonthsSelection();
  });

  // Calendar rendering
  function renderCalendar(year, month) {
    monthTitle.textContent = `${MONTHS[month]} ${year}`;
    daysGrid.innerHTML = '';

    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();

    // День недели первого дня (понедельник=0)
    let startWeekDay = firstDay.getDay() - 1;
    if (startWeekDay < 0) startWeekDay = 6; // Воскресенье — последний день

    // Дни предыдущего месяца для заполнения пустот в календаре
    let prevMonthDays = [];
    if (startWeekDay > 0) {
      const prevMonthLastDay = new Date(year, month, 0).getDate();
      for(let i = startWeekDay - 1; i >= 0; i--) {
        prevMonthDays.push(prevMonthLastDay - i);
      }
    }

    // Дни следующего месяца чтобы заполнить до конца недели
    const totalCells = 42; // 6 недель по 7 дней
    const nextMonthDaysCount = totalCells - (prevMonthDays.length + daysInMonth);

    // Сегодня для подсветки
    const today = new Date();
    const isCurrentMonth = (today.getFullYear() === year) && (today.getMonth() === month);
    const todayDate = isCurrentMonth ? today.getDate() : -1;

    // Рисуем дни предыдущего месяца
    prevMonthDays.forEach(d => {
      const div = document.createElement('div');
      div.textContent = d;
      div.className = 'day other';
      daysGrid.appendChild(div);
    });

    // Рисуем дни текущего месяца
    for(let d=1; d<=daysInMonth; d++) {
      const div = document.createElement('div');
      div.textContent = d;
      div.className = 'day';
      if (d === todayDate) div.classList.add('today');
      daysGrid.appendChild(div);
    }

    // Дни следующего месяца
    for(let d=1; d<=nextMonthDaysCount; d++) {
      const div = document.createElement('div');
      div.textContent = d;
      div.className = 'day other';
      daysGrid.appendChild(div);
    }
  }

  // Навигация между месяцами
  prevMonthBtn.addEventListener('click', () => {
    if (currentMonth === 0) {
      if (YEARS.indexOf(currentYear) > 0) {
        currentYear = YEARS[YEARS.indexOf(currentYear)-1];
        currentMonth = 11;
      }
    } else {
      currentMonth--;
    }
    renderCalendar(currentYear, currentMonth);
    updateYearSelection();
    updateMonthsSelection();
  });

  nextMonthBtn.addEventListener('click', () => {
    if (currentMonth === 11) {
      if (YEARS.indexOf(currentYear) < YEARS.length-1) {
        currentYear = YEARS[YEARS.indexOf(currentYear)+1];
        currentMonth = 0;
      }
    } else {
      currentMonth++;
    }
    renderCalendar(currentYear, currentMonth);
    updateYearSelection();
    updateMonthsSelection();
  });

  // Переключение экранов
  function showScreenCalendar() {
    screenSelect.classList.add('hidden-left');
    screenSelect.classList.remove('hidden-right');
    screenCalendar.classList.remove('hidden-right');
    screenCalendar.classList.remove('hidden-left');
  }

  function showScreenSelect() {
    screenSelect.classList.remove('hidden-left');
    screenSelect.classList.remove('hidden-right');
    screenCalendar.classList.add('hidden-right');
    screenCalendar.classList.add('hidden-left');
  }

  openCalendarBtn.addEventListener('click', () => {
    showScreenCalendar();
    renderCalendar(currentYear, currentMonth);
  });

  toSelectorBtn.addEventListener('click', () => {
    showScreenSelect();
  });

  toSelectBtn.addEventListener('click', () => {
    showScreenSelect();
  });

  // Инициализация
  renderYearRow();
  renderMonthsGrid();
  renderYearSelect();
  updateYearSelection();
  updateMonthsSelection();

  // Первый экран виден по умолчанию
  showScreenSelect();

  // Обработка resize - не требуется, т.к. flexbox все сам адаптирует
</script>
</body>
</html>
